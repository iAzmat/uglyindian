<% content_for :head do %>
    <style type="text/css">
    html, body, #map-canvas { height: 100%; margin: 0; padding: 0;}
    </style>
    <script type="text/javascript" src="//maps.google.com/maps/api/js?sensor=true">
    </script>
    <script type="text/javascript">
      function initialize() {
        var points = <%= raw @spotfixes.to_json %>;
        console.log(points)
        var mapOptions = {
          center: { lat: 12.9715987, lng: 77.5945627 },
          zoom: 14
        };
        var map = new google.maps.Map(document.getElementById('map-canvas'),
            mapOptions);
        var markers = [];
        console.log(points.length);
        for (var i = 0; i < points.length; i++) {
          console.log(points.length);
          var latLng = new google.maps.LatLng(points[i].latitude,
              points[i].longitude);
          var marker = new google.maps.Marker({'position': latLng});
          markers.push(marker);
        };
        var markerCluster = new MarkerClusterer(map, markers);
      }

      google.maps.event.addDomListener(window, 'load', initialize);
    </script>
<% end %>


<div id="pushobj">
    <%= image_tag 'intro.png', size: '250x100' %>
    <div id="outer-map" style="width:100%; height: 100%; position: absolute">
        <div id="map-canvas"></div>
    </div>
</div>